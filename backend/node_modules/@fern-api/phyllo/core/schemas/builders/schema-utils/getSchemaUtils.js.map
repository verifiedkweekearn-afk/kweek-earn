{
  "version": 3,
  "sources": ["../../../../src/core/schemas/builders/schema-utils/getSchemaUtils.ts"],
  "sourcesContent": ["import { BaseSchema, Schema } from \"../../Schema\";\nimport { OptionalSchema, OPTIONAL_BRAND } from \"./types\";\n\nexport interface SchemaUtils<Raw, Parsed> {\n  optional: () => OptionalSchema<Raw, Parsed>;\n  transform: <PostTransform>(transformer: BaseSchema<Parsed, PostTransform>) => Schema<Raw, PostTransform>;\n}\n\nexport function getSchemaUtils<Raw, Parsed>(schema: BaseSchema<Raw, Parsed>): SchemaUtils<Raw, Parsed> {\n  return {\n    optional: () => optional(schema),\n    transform: (transformer) => transform(schema, transformer),\n  };\n}\n\n/**\n * schema utils are defined in one file to resolve issues with circular imports\n */\n\nexport function optional<Raw, Parsed>(schema: BaseSchema<Raw, Parsed>): OptionalSchema<Raw, Parsed> {\n  const baseSchema: BaseSchema<Raw | null | undefined, Parsed | undefined> = {\n    parse: (raw, opts) => (raw != null ? schema.parse(raw, opts) : undefined),\n    json: (parsed, opts) => (parsed != null ? schema.json(parsed, opts) : undefined),\n  };\n\n  return {\n    ...OPTIONAL_BRAND,\n    ...baseSchema,\n    ...getSchemaUtils(baseSchema),\n  };\n}\n\nexport function transform<PreTransformRaw, PreTransformParsed, PostTransform>(\n  schema: BaseSchema<PreTransformRaw, PreTransformParsed>,\n  transformer: BaseSchema<PreTransformParsed, PostTransform>\n): Schema<PreTransformRaw, PostTransform> {\n  const baseSchema: BaseSchema<PreTransformRaw, PostTransform> = {\n    parse: (raw, opts) => {\n      const postTransformParsed = schema.parse(raw, opts);\n      return transformer.parse(postTransformParsed, opts);\n    },\n    json: (parsed, opts) => {\n      const preTransformParsed = transformer.json(parsed, opts);\n      return schema.json(preTransformParsed, opts);\n    },\n  };\n\n  return {\n    ...baseSchema,\n    ...getSchemaUtils(baseSchema),\n  };\n}\n"],
  "mappings": ";;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA,mBAA+C;AAOxC,wBAAqC,QAA2D;AACrG,SAAO;AAAA,IACL,UAAU,MAAM,SAAS,MAAM;AAAA,IAC/B,WAAW,CAAC,gBAAgB,UAAU,QAAQ,WAAW;AAAA,EAC3D;AACF;AAMO,kBAA+B,QAA8D;AAClG,QAAM,aAAqE;AAAA,IACzE,OAAO,CAAC,KAAK,SAAU,OAAO,OAAO,OAAO,MAAM,KAAK,IAAI,IAAI;AAAA,IAC/D,MAAM,CAAC,QAAQ,SAAU,UAAU,OAAO,OAAO,KAAK,QAAQ,IAAI,IAAI;AAAA,EACxE;AAEA,SAAO;AAAA,IACL,GAAG;AAAA,IACH,GAAG;AAAA,IACH,GAAG,eAAe,UAAU;AAAA,EAC9B;AACF;AAEO,mBACL,QACA,aACwC;AACxC,QAAM,aAAyD;AAAA,IAC7D,OAAO,CAAC,KAAK,SAAS;AACpB,YAAM,sBAAsB,OAAO,MAAM,KAAK,IAAI;AAClD,aAAO,YAAY,MAAM,qBAAqB,IAAI;AAAA,IACpD;AAAA,IACA,MAAM,CAAC,QAAQ,SAAS;AACtB,YAAM,qBAAqB,YAAY,KAAK,QAAQ,IAAI;AACxD,aAAO,OAAO,KAAK,oBAAoB,IAAI;AAAA,IAC7C;AAAA,EACF;AAEA,SAAO;AAAA,IACL,GAAG;AAAA,IACH,GAAG,eAAe,UAAU;AAAA,EAC9B;AACF;",
  "names": []
}
